<!DOCTYPE html>


<html lang="en">


<head>
  <meta charset="utf-8" />
   
  <meta name="keywords" content="Hexo,Hexo主题,代码,博客,游戏" />
   
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
    Mysql面试个人总结 |  Ronan Blog
  </title>
  <meta name="generator" content="hexo-theme-ayer">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="/dist/main.css">

  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
  
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

  
  

  

<link rel="alternate" href="/atom.xml" title="Ronan Blog" type="application/atom+xml">
<link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head>

</html>

<body>
  <div id="app">
    
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-database"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  Mysql面试个人总结
</h1>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/cklqjzous0006ouq18dycafit/" class="article-date">
  <time datetime="2020-01-03T11:07:03.000Z" itemprop="datePublished">2020-01-03</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Interview/">Interview</a> / <a class="article-category-link" href="/categories/Mysql/">Mysql</a>
  </div>
  
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> Word count:</span>
            <span class="post-count">3.1k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> Reading time≈</span>
            <span class="post-count">12 min</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <h1>Engines</h1>
<p>InnoDB, MEMORY, MyISAM</p>
<h2 id="myisam-vs-innodb">MyISAM vs InnoDB</h2>
<p><a target="_blank" rel="noopener" href="https://dba.stackexchange.com/questions/1/what-are-the-main-differences-between-innodb-and-myisam">Reference</a></p>
<table>
<thead>
<tr>
<th></th>
<th>min lock level</th>
<th>support transaction and crash recovery</th>
<th>support foreign key</th>
<th>support MVCC</th>
</tr>
</thead>
<tbody>
<tr>
<td>InnoDB</td>
<td>row-level</td>
<td>YES</td>
<td>YES</td>
<td>YES</td>
</tr>
<tr>
<td>MyISAM</td>
<td>table-level</td>
<td>NO</td>
<td>NO</td>
<td>NO</td>
</tr>
</tbody>
</table>
<p>在InnoDB中，表数据文件本身就是按B+Tree组织的一个索引结构（主索引）。</p>
<h3 id="mvcc">MVCC</h3>
<ol>
<li>MVCC是一种并发控制的方法</li>
<li>MVCC只在 READ COMMITTED 和 REPEATABLE READ 两个隔离级别下工作，因为 READ UNCOMMITTED 总是读取最新的数据行, 而不是符合当前事务版本的数据行。而 SERIALIZABLE 则会对所有读取的行都加锁。</li>
</ol>
<h1>Index</h1>
<p><a target="_blank" rel="noopener" href="https://blog.codinglabs.org/articles/theory-of-mysql-index.html">这篇非常吊</a><br>
索引本身也很大，不可能全部存储在内存中，因此索引往往以索引文件的形式存储的磁盘上。这样的话，索引查找过程中就要产生磁盘I/O消耗。<br>
相对于内存存取，I/O存取的消耗要高几个数量级，所以评价一个数据结构作为索引的优劣最重要的指标就是在查找过程中磁盘I/O操作次数的渐进复杂度。<br>
换句话说，索引的结构组织要尽量减少查找过程中磁盘I/O的存取次数。</p>
<ol>
<li>B-Tree Index:
<ol>
<li>MyISAM: Data address(Not Data) is stored in B+Tree leaves data field, which is called  nonclustered index <br><br>
<img src="https://img-blog.csdn.net/20180421144534845?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xKRlBIUA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="Nonclustered Index"></li>
<li>InnoDB:<br>
<a target="_blank" rel="noopener" href="https://www.xaprb.com/blog/2006/07/04/how-to-exploit-mysql-index-optimizations/">Reference1</a><br>
<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c3fb0b01c44d">Reference2</a>
<ol>
<li>Clustered/Primary Index(聚集索引/主键索引)： leaves store primary keys and relevant row(数据页) <br><br>
<img src="https://img-blog.csdn.net/20180421144550724?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0xKRlBIUA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="Clustered Index">
<ol>
<li>InnoDB creates a clustered index for every table.</li>
<li>If the table has a primary key, that is the clustered index.</li>
<li>If not, InnoDB internally assigns a six-byte unique ID to every row and uses that as the clustered index.</li>
</ol>
</li>
<li>secondary index(辅助索引)： leaves store primary keys(use primary key to find row later, which means it will search indexes twice) <br><br>
<img src="https://upload-images.jianshu.io/upload_images/1293895-eeb9baea003174f8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/543/format/webp" alt="Secondary Index"></li>
<li>Hence, we don’t use big data structure for primary key since it will increase the size of secondary index</li>
<li>recommend to use auto-increase key as primary key(因为非单调的主键会造成在插入新记录时数据文件为了维持B+Tree的特性而频繁的分裂调整，十分低效)</li>
<li>节点大小为磁盘页的整数倍</li>
</ol>
</li>
</ol>
</li>
<li>Hash Index:</li>
<li>bitmap Index:</li>
<li>R-Tree Index<br>
<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/index-btree-hash.html">Comparison of B-Tree and Hash Indexes</a></li>
<li><a target="_blank" rel="noopener" href="https://yq.aliyun.com/articles/62419">Covering Index</a>(覆盖索引): 指一个查询语句的执行只需要从辅助索引中就可以得到查询记录，而不需要查询聚集索引中的记录。也可以称之为实现了索引覆盖。<br>
即，一个索引包含或者说覆盖所有需要查询的字段的值</li>
<li>联合索引：KEY test_col1_col2_col3 on test(col1,col2,col3);实际上建立了(col1)、(col1,col2)、(col,col2,col3)三个索引</li>
<li>最左匹配（前缀）原则：（在生成的b树索引中，索引首先根据第一个字段来排列顺序，然后才是之后的字段）
<ol>
<li>where后的条件语句要满足(col1=??)、(col1=?? and col2=??)、(col1=?? and col2=?? and col3=?)</li>
<li>不可以是(col=?? and col3=?)，不能漏掉col2</li>
<li>顺序没关系(col2=?? and col1=?? and col3=?)是可以的，因为mysql的查询优化器会重新调整他们的位子</li>
</ol>
</li>
<li>如何选择索引顺序<br>
比较count(DISTINCT(column))/count(*)，选择大的那个</li>
<li>避免多个范围条件：因为mysql只会选择其中一个索引</li>
<li>索引的坏处：
<ol>
<li>索引文件本身要消耗存储空间</li>
<li>索引会加重插入、删除和修改记录时的负担</li>
<li>因此数据量少的表或者是count(DISTINCT(column))/count(*)小的表不建议建索引(data sparsity)</li>
</ol>
</li>
</ol>
<h2 id="根据where建立索引">根据Where建立索引</h2>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/rjzheng/p/12557314.html">Reference</a></p>
<h2 id="为什么用b-树而不是红黑树或者其他数据结构">为什么用B+树而不是红黑树或者其他数据结构</h2>
<p>主要和磁盘读取存储有关，为了减少IO，磁盘不会按需读取，一般是磁盘预读（即使只需要一个字节，磁盘也会从这个位置开始，顺序向后读取一定长度的数据放入内存）。<br>
预读的长度一般为页（page）的整倍数。页是计算机管理存储器的逻辑块，硬件及操作系统往往将主存和磁盘存储区分割为连续的大小相等的块，<br>
每个存储块称为一页（在许多操作系统中，页得大小通常为4k），主存和磁盘以页为单位交换数据。</p>
<p>B树索引，每次新建节点时会直接申请一个页，实现了一个node一次IO读取。<br>
B-Tree中一次检索最多需要h-1次I/O（根节点常驻内存），渐进复杂度为O(h)=O(log_d{N})。一般实际应用中，出度d是非常大的数字，通常超过100，因此h非常小（通常不超过3）。<br>
而红黑树这种结构，h明显要深的多，效率明显比B-Tree差很多。</p>
<h2 id="为什么用b-树而不是b树">为什么用B+树而不是B树</h2>
<ol>
<li>B+树可以实现区间访问，B树不行</li>
<li>B+树IO访问次数少，因为非叶子节点都是索引不是数据</li>
</ol>
<h2 id="为什么要使用一个与业务无关的自增字段作为主键">为什么要使用一个与业务无关的自增字段作为主键</h2>
<p>mysql的InnoDB引擎中使用的是B树，如果表使用自增主键，那么每次插入新的记录，记录就会顺序添加到当前索引节点的后续位置，当一页写满，就会自动开辟一个新的页。<br>
非自增主键（如果身份证号或学号等），由于每次插入主键的值近似于随机，因此每次新纪录都要被插到现有索引页得中间某个位置，此时MySQL不得不为了将新记录插到合适位置而移动数据。<br>
业务有关的字段肯定是无序的，所以不能用来做主键。</p>
<h1>原子性和持久性的实现原理</h1>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/rjzheng/p/10841031.html">原子性和一致性</a></p>
<ol>
<li>Mysql怎么保证原子性：利用Innodb的undo log</li>
<li>Mysql怎么保持持久性：利用Innodb的redo log</li>
</ol>
<h1>隔离级别</h1>
<p><img src="https://developer.ibm.com/zh/technologies/databases/articles/os-mysql-transaction-isolation-levels-and-locks/" alt="隔离级别"></p>
<table>
<thead>
<tr>
<th></th>
<th>脏读</th>
<th>不可重复读</th>
<th>幻读</th>
</tr>
</thead>
<tbody>
<tr>
<td>read uncommitted</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>read committed</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>read repeatable</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>serializable</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>mysql默认级别：read repeatable</p>
<h2 id="不可重复读和幻读">不可重复读和幻读</h2>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/itcomputer/articles/5133254.html">Reference</a><br>
不可重复读重点在于update，而幻读的重点在于insert</p>
<ol>
<li>在可重复读中，该sql第一次读取到数据后，就将这些数据加锁，其它事务无法修改这些数据，就可以实现可重复读了</li>
<li>但这种方法却无法锁住insert的数据，所以当事务A先前读取了数据，或者修改了全部数据，事务B还是可以insert数据提交，<br>
这时事务A就会发现莫名其妙多了一条之前没有的数据，这就是幻读，不能通过行锁来避免；serializable会串行执行指令，给读操作加一把读共享锁，在写的时候<br>
这个锁是锁住的，不能读，因此也消除了幻读</li>
</ol>
<h1>DBMS Architecture</h1>
<ol>
<li>All data are stored in data files, which is grouped in table space<br>
(file group: Logical grouping of several data files that store data with similar characteristics)</li>
<li>Data files(SQL )</li>
<li>Listener: listen for client request(SQL request), and then pass to User process</li>
<li>User: manage each client session</li>
<li>Scheduler: organize the concurrent execution of SQL requests</li>
<li>Lock Manager: manages all locks placed on database objects, including disk pages</li>
<li>Optimizer: analyze SQL queries and finds the most efficient way to access the data</li>
</ol>
<h2 id="query-processing">Query Processing</h2>
<ol>
<li>Parsing phase: use access plan(use the access plan if exist, if not optimizer will choose the best one)</li>
<li>Execution phase: all IO operations indicated in the access plan are executed
<ol>
<li>acquire the locks</li>
<li>retrieve data and place in data cache</li>
<li>process transaction management</li>
</ol>
</li>
<li>Fetching phase: return rows of resulting query result set</li>
</ol>
<h2 id="查询优化">查询优化</h2>
<p>There are two optimizer rule-based optimizer and cost-based optimizer.</p>
<ol>
<li>MySQL使用了基于成本的优化器，可以通过查询当前会话的last_query_cost的值来得到其计算当前查询的成本</li>
<li>优化策略
<ol>
<li>重新定义表的关联顺序</li>
<li>优化MIN()和MAX()函数（找某列的最小值，如果该列有索引，只需要查找B+Tree索引最左端，反之则可以找到最大值，具体原理见下文）</li>
<li>提前终止查询（比如：使用Limit时，查找到满足数量的结果集后会立即终止查询）</li>
<li>优化排序（在老版本MySQL会使用两次传输排序，即先读取行指针和需要排序的字段在内存中对其排序，然后再根据排序结果去读取数据行，而新版本采用的是单次传输排序，也就是一次读取所有的数据行，然后根据给定的列排序。对于I/O密集型应用，效率会高很多）</li>
<li>etc</li>
</ol>
</li>
<li>优化器会生成执行计划</li>
<li>优化器提示(hint): <code>SELECT select_list FROM table_name USE INDEX(index_list) WHERE condition;</code><br>
<img src="https://ask.qcloudimg.com/http-save/yehe-1667832/qfvxpyxocc.jpeg?imageView2/2/w/1620" alt="查询过程"></li>
</ol>
<p><img src="https://pic4.zhimg.com/80/v2-43ccb9ca6d510bc5a7b7d023ff9bcf87_1440w.jpg" alt="查询过程"></p>
<h2 id="查询缓存">查询缓存</h2>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1103154">Reference</a></p>
<ol>
<li>MySQL将缓存存放在一个引用表（不要理解成table，可以认为是类似于HashMap的数据结构），通过一个哈希值索引，这个哈希值通过查询本身、当前要查询的数据库、客户端协议版本号等一些可能影响结果的信息计算得来。所以两个查询在任何字符上的不同（例如：空格、注释），都会导致缓存不会命中。</li>
<li>查询中包含任何用户自定义函数、存储函数、用户变量、临时表、MySQL库中的系统表，其查询结果都不会被缓存</li>
<li>MySQL的查询缓存系统会跟踪查询中涉及的每个表，如果这些表（数据或结构）发生变化，那么和这张表相关的所有缓存数据都将失效。</li>
<li>任何的查询语句在开始之前都必须经过检查，即使这条SQL语句永远不会命中缓存</li>
<li>通过SQL_CACHE和SQL_NO_CACHE来控制某个查询语句是否需要进行缓存(可以将query_cache_type设置为DEMAND，这时只有加入SQL_CACHE的查询才会走缓存，其他查询则不会)</li>
</ol>
<h2 id="语法解析和预处理">语法解析和预处理</h2>
<p><a target="_blank" rel="noopener" href="https://tech.meituan.com/2018/05/20/sql-parser-used-in-mtdp.html">SQL解析过程</a></p>
<ol>
<li>词法分析(MySQLLex): 将输入转化成一个个Token(e.g. <code>select username from user</code> -&gt; 4个token select, username, from和user)。具体代码在sql/lex.h和sql/sql_lex.cc文件中</li>
<li>语法分析：用于生成语法树，使用了Bison
<ol>
<li>e.g. <code>select username, ismale from userinfo where age &gt; 20 and level &gt; 5 and 1 = 1</code> 会生成如下语法树<br>
<img src="https://awps-assets.meituan.net/mit-x/blog-images-bundle-2018a/a74c9e9c.png" alt="语法树"></li>
</ol>
</li>
</ol>
<h1>Optimization</h1>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=Mzg2OTA0Njk0OA==&amp;mid=2247485117&amp;idx=1&amp;sn=92361755b7c3de488b415ec4c5f46d73&amp;chksm=cea24976f9d5c060babe50c3747616cce63df5d50947903a262704988143c2eeb4069ae45420&amp;token=79317275&amp;lang=zh_CN#rd">Reference</a></p>
<ol>
<li>通常来讲，没有太大的必要使用DECIMAL数据类型。即使是在需要存储财务数据时，仍然可以使用BIGINT。比如需要精确到万分之一，那么可以将数据乘以一百万然后使用BIGINT存储。这样可以避免浮点数计算不准确和DECIMAL精确计算代价高的问题。</li>
<li>大表ALTER TABLE非常耗时，MySQL执行大部分修改表结果操作的方法是用新的结构创建一个张空表，从旧表中查出所有的数据插入新表，然后再删除旧表。尤其当内存不足而表又很大，而且还有很大索引的情况下，耗时更久。当然有一些奇技淫巧可以解决这个问题，有兴趣可自行查阅。</li>
<li>优化<code>select * from table where age &gt; 20 limit 1000000,10</code>: <code>select * from table where id in (select id from table where age &gt; 20 limit 1000000,10) </code><br>
子查询使用的索引是覆盖索引，不需要回表</li>
<li>在检索效率上来讲,char &gt; varchar</li>
</ol>
<h2 id="possible-reasons-if-sql-is-executed-slowly">Possible Reasons if SQL is executed slowly</h2>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=Mzg2OTA0Njk0OA==&amp;mid=2247485185&amp;idx=1&amp;sn=66ef08b4ab6af5757792223a83fc0d45&amp;chksm=cea248caf9d5c1dc72ec8a281ec16aa3ec3e8066dbb252e27362438a26c33fbe842b0e0adf47&amp;token=79317275&amp;lang=zh_CN#rd">Reference</a></p>
<ol>
<li>Mysql is flushing dirty pages(When you update a row, MySQL updates it in the buffer pool, marking the page as dirty.)
<ol>
<li>When redo log is full</li>
<li>When memory is not enough</li>
<li>MYSQL think system is in low load and it is a suitable time to flush</li>
</ol>
</li>
<li>Encounter locks when executing</li>
<li>No index for query fields</li>
<li>MYSQL doesn’t use index properly when executing</li>
</ol>
<h1>Others</h1>
<ol>
<li>varchar(10)和int(10)各代表什么含义: varchar的10代表了申请的空间长度,也是可以存储的数据的最大长度,而int的10只是代表了展示的长度,不足10位以0填充.<br>
也就是说,int(1)和int(10)所能存储的数字大小以及占用的空间都是相同的,只是在展示时按照长度展示</li>
</ol>
<h2 id="olap-online-analytical-processing">OLAP(Online Analytical Processing)</h2>
<p><img src="http://bytes.usc.edu/cs585/s20_db0ds1ml2agi/lectures/BI/pics/s039.png" alt="OLAP"></p>
<h1><a target="_blank" rel="noopener" href="https://my.oschina.net/MiniBu/blog/270521">SQL注入和预防</a></h1>
<p>e.g. 在程序中<code>String sql = &quot;select * from user_table where username= (userName) and password= (password);</code><br>
usrName传入<code>&quot;or 1 = 1 –</code>，得到<code>SELECT * FROM user_table WHERE username=&quot;or 1 = 1 -- and password='’</code><br>
<code>1=1</code>条件一定成功，<code>--</code>将后面的语句注视掉，甚至可以传入<code>drop database</code></p>
<p>预防：</p>
<ol>
<li>采用预编译语句集(PreparedStatement)：内置了处理SQL注入的能力<br>
因为 preparedStatement 中可以不包含数据，只包含操作，不需要用数据来拼接 SQL。<br>
编译过程识别了关键字、执行逻辑之类的东西，编译结束了这条SQL语句能干什么就定了。<br>
而在编译之后加入注入的部分，就已经没办法改变执行逻辑了，这部分就只能是相当于输入字符串被处理。</li>
<li>限制数据库权限</li>
<li>检查用户输入的合法性</li>
<li>对特殊字符’,&quot;进行转义</li>
</ol>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        share
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://ronannnn.github.io/2020/cklqjzous0006ouq18dycafit/" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>  
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Index/" rel="tag">Index</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/InnoDB/" rel="tag">InnoDB</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Interview/" rel="tag">Interview</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Mysql/" rel="tag">Mysql</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/2020/cklqjzov0000houq18u0k8k1f/" class="article-nav-link">
        <strong class="article-nav-caption">Prev</strong>
        <div class="article-nav-title">
          
            OS个人总结
          
        </div>
      </a>
    
    
      <a href="/2020/cklqjzovr0025ouq1bvihei5t/" class="article-nav-link">
        <strong class="article-nav-caption">Next</strong>
        <div class="article-nav-title">Java面试个人总结</div>
      </a>
    
  </nav>

  
   
     
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2021
        <i class="ri-heart-fill heart_icon"></i> Ronan Chen
      </li>
    </ul>
    <ul>
      <li>
        
        
        
        Powered by <a href="https://hexo.io" target="_blank">Hexo</a>
        <span class="division">|</span>
        Theme - <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>
        
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/logo.svg" alt="Ronan Blog"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">@Me</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->


<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: '.tocbot',
    contentSelector: '.article-entry',
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: 'main',
    positionFixedSelector: '.tocbot',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto'
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>

<!-- MathJax -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
  });

  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.6/unpacked/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
  var ayerConfig = {
    mathjax: true
  }
</script>

<!-- Katex -->


    
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
        <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"></script>
        
    


<!-- busuanzi  -->

<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->


<link rel="stylesheet" href="/css/clipboard.css">

<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>


<!-- CanvasBackground -->


    
  </div>
</body>

</html>